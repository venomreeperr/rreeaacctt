import{a as C}from"./chunk-VL2CUAE4.mjs";import{a as b}from"./chunk-GXQ2EBSK.mjs";import{a as E,b as d,c as T}from"./chunk-7RJG5BRD.mjs";import*as r from"react";import{useThree as f,useFrame as I}from"@react-three/fiber";import{Fragment as P,jsx as y,jsxs as k}from"react/jsx-runtime";var F=a=>typeof a=="function",N=r.forwardRef((v,H)=>{var R=v,{envMap:a,resolution:x=256,frames:s=1/0,children:n,makeDefault:l}=R,c=T(R,["envMap","resolution","frames","children","makeDefault"]);let u=f(({set:e})=>e),O=f(({camera:e})=>e),o=f(({size:e})=>e),t=r.useRef(null),i=r.useRef(null),p=C(x);r.useLayoutEffect(()=>{c.manual||t.current.updateProjectionMatrix()},[o,c]),r.useLayoutEffect(()=>{t.current.updateProjectionMatrix()}),r.useLayoutEffect(()=>{if(l){let e=O;return u(()=>({camera:t.current})),()=>u(()=>({camera:e}))}},[t,l,u]);let g=0,h=null,m=F(n);return I(e=>{m&&(s===1/0||g<s)&&(i.current.visible=!1,e.gl.setRenderTarget(p),h=e.scene.background,a&&(e.scene.background=a),e.gl.render(e.scene,t.current),e.scene.background=h,e.gl.setRenderTarget(null),i.current.visible=!0,g++)}),k(P,{children:[y("orthographicCamera",d(E({left:o.width/-2,right:o.width/2,top:o.height/2,bottom:o.height/-2,ref:b([t,H])},c),{children:!m&&n})),y("group",{ref:i,children:m&&n(p.texture)})]})});export{N as a};
